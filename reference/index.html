<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>libcester: Main Page</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">libcester
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">libcester Documentation</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><div class="image">
<img src="https://github.com/exoticlibraries/libcester/raw/main/docs/libcester.png"/>
</div>
<h1>libcester</h1>
<p>A robust header only unit testing framework for C programming language. Support function mocking, memory leak detection, crash report.</p>
<p>cester is a header only automated testing framework for the C programming language, it requires no dependency and can be downloaded and used in a project immediately. Works on various platorms including embedded systems and compatible with various compilers. Allows shared instance <code>TestInstance</code> object in which each test cases can use to share data and access the command line arguments.</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="cester_8h.html">exotic/cester.h</a>&gt;</span></div><div class="line"></div><div class="line"><a class="code" href="cester_8h.html#a4681c51ac1793cf49a7d90fac6eabe74">CESTER_TEST</a>(test_one, inst,</div><div class="line">    <a class="code" href="cester_8h.html#a46a752bc620dbdfbc4f5f851307b0d72">cester_assert_equal</a>(NULL, ((<span class="keywordtype">void</span>*)0));    </div><div class="line">)</div></div><!-- fragment --><p>The test results can be outputed as various format JunitXML, Test Anything Protocol, Test Anything Protocol Version 13 and text. Visit <a href="https://exoticlibraries.github.io/libcester/docs/">https://exoticlibraries.github.io/libcester/docs/</a> for documentation and tutorials. </p><hr/>
<h2>Table of content</h2>
<ul>
<li><a href="#standards-compliance-and-portability">Standards Compliance and Portability</a></li>
<li><a href="#installation">Installation</a><ul>
<li><a href="#install">Install</a><ul>
<li><a href="#windows">Windows</a></li>
<li><a href="#linux">Linux</a></li>
<li><a href="#other-platforms">Other platforms</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#documentation">Documentation</a></li>
<li><a href="#usage">Usage</a><ul>
<li><a href="#writing-test">Writing and Running test</a></li>
<li><a href="#cester-options">Cester options</a></li>
<li><a href="#macros">Macros</a></li>
</ul>
</li>
<li><a href="#mocking">Mocking</a></li>
<li><a href="#faq">FAQ</a><ul>
<li><a href="#no-test-case-detected">No test case detected</a></li>
</ul>
</li>
<li><a href="#how-it-works">How it works</a></li>
<li><a href="#contributing">Contributing</a></li>
<li><a href="#references">References</a></li>
<li><a href="#license">License</a></li>
</ul>
<h2>Standards Compliance and Portability</h2>
<p>The project is compliant with the original C language specification ISO/IEC 9899:1990 and the first POSIX specification IEEE Std 1003.1-1988 which ensures the project compatibility in various environments. It also makes use of features in the newer revisions ISO/IEC 9899:1999 and IEEE Std 1003.1-2001 whenever possible.</p>
<p>Even though the project is designed for C, but also works with C++ as it is compatible with C++98 Standard (ISO/IEC 14882:1998), C++03 Standard (ISO/IEC 14882:2003) and C++11 Standard (ISO/IEC 14882:2011).</p>
<p>The project can be used with any C or C++ compiler. There are optional macros and options that can be used to attain the desired output in the case of undesired results.</p>
<h2>Installation</h2>
<p>If you install the library file <code><a class="el" href="cester_8h.html">cester.h</a></code> using any of the commands below, it can be included in your test like <code>&lt;<a class="el" href="cester_8h.html">exotic/cester.h</a>&gt;</code>.</p>
<h3>Windows</h3>
<p>Install the library using powershell. It auto detect your insalled C and C++ compilers include directory and install libcester into the include folder. Execute the command in powershell as admin.</p>
<div class="fragment"><div class="line">Set-ExecutionPolicy Bypass -Scope Process -Force; iex ((New-Object System.Net.WebClient).DownloadString(&#39;https://exoticlibraries.github.io/libcester/cester.ps1&#39;))</div></div><!-- fragment --><h3>Linux</h3>
<p>Use the remote installation script to install libcester with bash. Before running this command ensure you are root <code>su</code> so it can move <a class="el" href="cester_8h.html">cester.h</a> to the /usr/include/ folder.</p>
<div class="fragment"><div class="line">bash &lt;(curl -s https://exoticlibraries.github.io/libcester/cester.sh)</div></div><!-- fragment --><h3>Other platforms</h3>
<p>You can simply download the header file <code><a class="el" href="cester_8h.html">cester.h</a></code> from the repo into your project source folder and include it in your project. Download the file from <a href="https://github.com/exoticlibraries/libcester/releases">here</a>. The you can include it in your test relatively like <code>#include "cester.h"</code>.</p>
<h2>Documentation</h2>
<p>The <a href="https://exoticlibraries.github.io/libcester/docs/">documentation</a> provides several examples, tutorials, and detailed guides for using the library. While <a href="https://exoticlibraries.github.io/libcester/reference/">reference</a> provides a low-level overview of all the implemented APIs in the library.</p>
<p>Some of the documentation pages are listed below:</p>
<ul>
<li><a href="https://exoticlibraries.github.io/libcester/docs/assertions.html">Assertion Macros</a></li>
<li><a href="https://exoticlibraries.github.io/libcester/docs/mocking.html">Mocking</a></li>
<li><a href="https://exoticlibraries.github.io/libcester/docs/macros.html">Helper Macros</a></li>
<li><a href="https://exoticlibraries.github.io/libcester/docs/manual_test_registration.html">Manual Tests Registration</a></li>
<li><a href="https://exoticlibraries.github.io/libcester/docs/options.html">Cester Options</a></li>
<li><a href="https://exoticlibraries.github.io/libcester/docs/output_formats.html">Output Formats</a></li>
<li><a href="https://exoticlibraries.github.io/libcester/docs/test_for_failure.html">Testing for failures</a></li>
<li><a href="https://exoticlibraries.github.io/libcester/how_it_works/index.html">How it works</a></li>
</ul>
<h2>Usage</h2>
<h3>Writing and Running test</h3>
<p>The macro CESTER_TEST is used to create a test case, the first parameter is the test case name the second parameter is the test instance object which is used to share data between the test cases and also has the command line arguments object and count, the last parameter is the body of the test case. The following example defines a test case that chack if <code>NULL</code> is the same as <code>((void*)0)</code></p>
<div class="fragment"><div class="line"><span class="comment">//test.c</span></div><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="cester_8h.html">exotic/cester.h</a>&gt;</span></div><div class="line"></div><div class="line"><a class="code" href="cester_8h.html#a4681c51ac1793cf49a7d90fac6eabe74">CESTER_TEST</a>(test_one, inst,</div><div class="line">    <a class="code" href="cester_8h.html#a46a752bc620dbdfbc4f5f851307b0d72">cester_assert_equal</a>(NULL, ((<span class="keywordtype">void</span>*)0));    </div><div class="line">)</div><div class="line"></div><div class="line"><a class="code" href="cester_8h.html#a4681c51ac1793cf49a7d90fac6eabe74">CESTER_TEST</a>(test_two, inst,</div><div class="line">    <a class="code" href="cester_8h.html#a4906d3f737b8653a5f79e3f6509433c3">cester_assert_ptr_equal</a>(inst, NULL);    </div><div class="line">)</div></div><!-- fragment --><p>cester will automatically detect and register the test cases if the macro <code>__BASE_FILE__</code> is predefined by the compiler. If no test is detected see the <a href="#faq">FAQ</a> below on ways to make cester aware of the test case.</p>
<p>The test above can be compiled and run like below. <b>Do not forget to add the option -I. for gcc so it can find the <code>__BASE_FILE__</code></b>.</p>
<div class="fragment"><div class="line">gcc test.c -I.-o test</div><div class="line">./test</div><div class="line"></div><div class="line">  + (0.00s) test one</div><div class="line">  - (0.00s) test two</div><div class="line"></div><div class="line">AssertionError crash_test.c:10: in &#39;test_two&#39; =&gt; expected &#39;0761C50&#39;, received &#39;0000000&#39;</div><div class="line"></div><div class="line">Ran 2 test(s) in 0.01 Seconds</div><div class="line">Synthesis: FAILURE Tests: 2 | Passing: 1 | Failing: 1</div></div><!-- fragment --><h3>Macros</h3>
<p>Many predefined helper macros are present in cester, all cester macros begins with CESTER_ and cester_. The detail documentation of the macros is at <a href="https://exoticlibraries.github.io/libcester/docs/macros.html">Helper Macros</a>.</p>
<h2>Mocking</h2>
<p>cester supports mocking function. The mock feature currently works on GCC compiler because of the use of the <code>--wrap</code> option which is not supported on MAC OSX and might not be available in other compilers. The two macros <a href="https://exoticlibraries.github.io/libcester/docs/macros.html#cester-mock-simple-function">CESTER_MOCK_SIMPLE_FUNCTION</a> and <a href="https://exoticlibraries.github.io/libcester/docs/macros.html#cester-mock-function">CESTER_MOCK_FUNCTION</a> are used for function mocking.</p>
<p>The following test mocks a funtion that accept no parameter and return a value:</p>
<p><em>originals.c</em></p>
<div class="fragment"><div class="line"><span class="preprocessor">#ifndef ORIGINALS</span></div><div class="line"><span class="preprocessor">#define ORIGINALS</span></div><div class="line"></div><div class="line"><span class="keywordtype">int</span> multiply_by() {</div><div class="line">    <span class="keywordflow">return</span> 2;</div><div class="line">}</div><div class="line"></div><div class="line"><span class="keywordtype">int</span> multiply_a_number(<span class="keywordtype">int</span> a) {</div><div class="line">    <span class="keywordflow">return</span> a * multiply_by() ;</div><div class="line">}</div><div class="line"><span class="preprocessor">#endif</span></div></div><!-- fragment --><p><em>test_mock.c</em></p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="cester_8h.html">exotic/cester.h</a>&gt;</span></div><div class="line"><span class="preprocessor">#include &quot;originals.c&quot;</span></div><div class="line"></div><div class="line"><a class="code" href="cester_8h.html#a8a6a76440950a47f00c288af35260b8f">CESTER_MOCK_FUNCTION</a>(multiply_by(), <span class="keywordtype">int</span>, {</div><div class="line">    <span class="keywordflow">return</span> 5;</div><div class="line">})</div><div class="line"></div><div class="line"><a class="code" href="cester_8h.html#a4681c51ac1793cf49a7d90fac6eabe74">CESTER_TEST</a>(check_mocked_function, <a class="code" href="structtest__instance.html">test_instance</a>,</div><div class="line">    <a class="code" href="cester_8h.html#a46a752bc620dbdfbc4f5f851307b0d72">cester_assert_equal</a>(multiply_a_number(2), 10);</div><div class="line">)</div></div><!-- fragment --><p>Compile the test file <em>test_mock.c</em> with the &ndash;wrap option e.g. in the example above the function <code>multiply_by</code> was mocked so the option <em>-Wl,&ndash;wrap=multiply_by</em> is supplied during compilation.</p>
<div class="fragment"><div class="line">gcc test_mock.c -I. -Wl,--wrap=multiply_by -o test_mock</div><div class="line">./test_mock</div><div class="line"></div><div class="line">+ (0.00s) check mocked function</div><div class="line"></div><div class="line">Ran 1 test(s) in 0.00 Seconds</div><div class="line">Synthesis: SUCCESS Tests: 1 | Passing: 1 | Failing: 0</div></div><!-- fragment --><p>More detailed explanation on mocking function can be seen at <a href="https://exoticlibraries.github.io/libcester/docs/mocking.html">https://exoticlibraries.github.io/libcester/docs/mocking.html</a>.</p>
<h3>Cester options</h3>
<p>cester accepts various options to tune it functionalities. Any command line parameter that starts with &ndash;cester- is treated as cester option otherwise it is ignored. All the available options can be viewed <a href="https://exoticlibraries.github.io/libcester/docs/options.html">here</a>.</p>
<p>The following options performs important task:</p>
<ul>
<li><b>&ndash;cester-noisolation</b>: instruct cester to run all the test in one single process. With this option signal will be used for crash reporting but if the test is compiled with the macro <code>CESTER_NO_SIGNAL</code> defined, cester will not be able to recover from critical crash therefore if a test case segfault the tests will terminate immediately.<ul>
<li><b>&ndash;cester-output</b>: Change the format in which the outpout is generated. Various format is supported, all the supported format can be viewed <a href="https://exoticlibraries.github.io/libcester/docs/output_formats.html">here</a>. E.g. to print the output in JunitXML format you supply the option <code>--cester-output=junitxml</code>.</li>
<li><b>&ndash;cester-nomemtest</b>: instruct cester to skip memory leak detection and test. Alternatively the test can be compiled with the macro <code>CESTER_NO_MEM_TEST</code> defined at the beginning of the source file.</li>
<li><b>&ndash;cester-verbose</b>: printf as much output as possible including passed test expression, output to the stdout from within the test case. This option combined with <b>&ndash;cester-minimal</b> prints out the output in a very sane format.</li>
<li><b>&ndash;cester-help</b>: to view all the options accepted by cester.</li>
</ul>
</li>
</ul>
<h2>FAQ</h2>
<h3>No test detected</h3>
<p>If no test was ran or your test cases were not detected, in most cases it because your compiler did not define the <code>__BASE_FILE__</code> macro. If you are using the Visual studio IDE you should define the macro in <code>Properties -&gt; C/C++ -&gt; Preprocessor -&gt; Preprocessor Definition</code> as <code>__BASE_FILE__="%(Filename)%(Extension)"</code>. Or you can add the macro at compile time as option to your compiler using the macro option. e.g. in gcc</p>
<div class="fragment"><div class="line">gcc -D__BASE_FILE__=\&quot;/the/path/to/yout/testfile.c\&quot; testfile.c -I.</div></div><!-- fragment --><p>You can also define the <code>__BASE_FILE__</code> at the beginning of your test file with the absolute path to the test file. E.g for the test file test.c:</p>
<div class="fragment"><div class="line"><span class="preprocessor">#define __BASE_FILE__ &quot;/path/to/test.c&quot;</span></div><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="cester_8h.html">exotic/cester.h</a>&gt;</span></div><div class="line"></div><div class="line"><a class="code" href="cester_8h.html#a4681c51ac1793cf49a7d90fac6eabe74">CESTER_TEST</a>(test1, <a class="code" href="structtest__instance.html">test_instance</a>,</div><div class="line">    <a class="code" href="cester_8h.html#a46a752bc620dbdfbc4f5f851307b0d72">cester_assert_equal</a>(NULL, NULL);</div><div class="line">)</div></div><!-- fragment --><p>Alternatively the test cases should be manually registered in the main method, you will have to disable cester main function by defining the macro CESTER_NO_MAIN.</p>
<div class="fragment"><div class="line"><span class="preprocessor">#define CESTER_NO_MAIN</span></div><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="cester_8h.html">exotic/cester.h</a>&gt;</span></div><div class="line"></div><div class="line"><a class="code" href="cester_8h.html#a4681c51ac1793cf49a7d90fac6eabe74">CESTER_TEST</a>(test1, <a class="code" href="structtest__instance.html">test_instance</a>,</div><div class="line">    <a class="code" href="cester_8h.html#a46a752bc620dbdfbc4f5f851307b0d72">cester_assert_equal</a>(NULL, NULL);</div><div class="line">)</div><div class="line"></div><div class="line"><a class="code" href="cester_8h.html#af6fdfc1a7963f6b2bf1196a5d75ceeec">CESTER_BODY</a>(</div><div class="line"><span class="keywordtype">int</span> <a class="code" href="cester_8h.html#a3c04138a5bfe5d72780bb7e82a18e627">main</a>(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span>** argv) {</div><div class="line">    <a class="code" href="cester_8h.html#a5d12fa79c77dfe56918e813950e1b96e">CESTER_REGISTER_TEST</a>(test1);</div><div class="line">    <span class="keywordflow">return</span> <a class="code" href="cester_8h.html#ae1c1f1eb8354492276bdbf70d8875f92">CESTER_RUN_ALL_TESTS</a>(argc, argv);</div><div class="line">}</div><div class="line">)</div></div><!-- fragment --><p>Visit this <a href="https://exoticlibraries.github.io/libcester/docs/manual_test_registration.html">link</a> for more detail on manual test registration.</p>
<h2>How it works</h2>
<p>The base file which is the file that contains the tests is included more than twice during the macro expansion process to define and register the test cases. The working principle is best explained by a thought experiment.</p>
<blockquote class="doxtable">
<p>Imagine a source file including a header file. Then imagine the header file including the source file that included it. Now imagine doing that three times in a row within the same header file. Proceed to imagine redefining all of the identifiers each time. Finally imagine doing all of that with preprocessor directives. What you ended up with is CHEAT - Sampsa Kiiskinen </p>
</blockquote>
<p>The project uses the same approach used by the <a href="https://github.com/Tuplanolla/cheat">cheat</a> project. It makes a very tricky use of the C preprocessor directive to achieve test cases registration so the developer can concentrate on writing the test only while cester manages the test registration, execution and analysis.</p>
<p>See the pages at <a href="https://exoticlibraries.github.io/libcester/how_it_works/index.html">how it works</a> for more explanation.</p>
<h2>Contributing</h2>
<p>If you have any issue or you want to request a feature you can open a request <a href="https://github.com/exoticlibraries/libcester/issues/new/choose">here</a> anytime and if you made some changes that should be added to the main project send in a <a href="https://github.com/exoticlibraries/libcester/compare">pull request</a>.</p>
<h2>References</h2>
<ul>
<li><a href="https://en.wikipedia.org/wiki/ANSI_C">ANSI C</a></li>
<li><a href="https://github.com/Tuplanolla/cheat">CHEAT</a></li>
<li><a href="https://exoticlibraries.github.io/">Exotic Libraries</a></li>
<li><a href="https://thecarisma.github.io/">Author</a></li>
</ul>
<h2>License</h2>
<p>MIT License Copyright (c) 2020, Adewale Azeez </p>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
